!function(){"use strict";class e{constructor(e,t){let{data:r,renderer:s}=e;this._initialArray=r,this._renderer=s,this._container=t}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class t{constructor(e,t,r){let{data:s,handleImageClick:n,handleTrashClick:i,handleLikeClick:a}=e;this._text=s.name,this._image=s.link,this._likes=s.likes,this._id=s._id,this._owner=s.owner,this._cardSelector=t,this._userId=r,this._handleImageClick=n,this._handleTrashClick=i,this._handleLikeClick=a}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".gallery__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".gallery__card-image"),t=this._element.querySelector(".gallery__card-place"),r=(this._element.querySelector(".gallery__card-like_counter"),this._element.querySelector(".gallery__card-trash-button"));return e.style.backgroundImage="url(".concat(this._image,")"),t.textContent=this._text,this._owner._id!==this._userId&&r.classList.remove("gallery__card-trash-button_active"),this._renderLikes(),this._element}_setEventListeners(){const e=this._element.querySelector(".gallery__card-like_button"),t=this._element.querySelector(".gallery__card-trash-button");this._element.querySelector(".gallery__card-image").addEventListener("click",(()=>this._handleImageClick())),e.addEventListener("click",(()=>this._handleLikeClick(this._id))),t.addEventListener("click",(()=>this._handleTrashClick(this._id)))}isLiked(){return this._likes.some((e=>e._id===this._userId))}updateLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){const e=this._element.querySelector(".gallery__card-like_button");this._element.querySelector(".gallery__card-like_counter").textContent=this._likes.length,this.isLiked()?e.classList.add("gallery__card-like_button_active"):e.classList.remove("gallery__card-like_button_active")}removeCard(){this._element.remove(),this._element=null}}var r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector)}_showInputError(e,t){const r=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),r.textContent=t,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){var t,r;r=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._popupSelector=e,this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_fadein"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_fadein"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupSelector.addEventListener("click",(e=>{e.target.classList.contains("close-button")&&this.close()})),this._popupSelector.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".form__button"),this._buttonText=this._submitButton.textContent}_getInputValues(){const e=Array.from(this._formSelector.querySelectorAll(".form__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formSelector.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._buttonText}}const i=document.querySelector(".avatar"),a=document.querySelector(".edit"),o=document.querySelector(".add"),l=document.querySelector(".image"),c=document.querySelector(".delete"),d=document.querySelector(".profile__edit-button"),_=(a.querySelector(".edit__close-button"),document.querySelector(".profile__add-button")),h=(o.querySelector(".add__close-button"),l.querySelector(".image__close-button"),document.getElementById("gallery-container"),document.querySelector(".gallery__container")),u=document.querySelector(".edit__form"),m=o.querySelector(".add__form"),p=document.querySelector(".avatar__form"),v=document.getElementById("name-input"),g=document.getElementById("job-input"),y=document.getElementById("avatar-input"),S=(document.querySelector(".profile__name"),document.querySelector(".profile__name-discription"),document.querySelector(".profile__image")),b={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},E=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))),L=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getUserInfo(){return E("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}sendUserInfo(e){return E("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.job})})}sendUserAavatar(e){return E("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}getInitialCards(){return E("".concat(this._baseUrl,"/cards"),{headers:this._headers})}sendNewCard(e){return E("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.image})})}deleteCard(e){return E("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}likeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6a85a377-e76e-4e72-85a9-79ee5208e36a","Content-Type":"application/json"}});let C;Promise.all([L.getInitialCards(),L.getUserInfo()]).then((t=>{let[r,s]=t;C=s._id;const n=new e({data:r,renderer:e=>{const t=q(e);n.addItem(t)}},h);n.renderItems(),I.setUserInfo({name:s.name,job:s.about}),I.setUserAvatar({avatar:s.avatar})})).catch((e=>{console.log(e)}));const f=new class extends s{open(e,t){const r=this._popupSelector.querySelector(".image__popup"),s=this._popupSelector.querySelector(".image__discription");r.src=e,r.alt=t,s.textContent=t,super.open()}}(l),k=new class extends s{constructor(e){super(e),this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".button"),this._text=this._submitButton.textContent}setAction(e){this._handleSubmit=e}setEventListeners(){this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}renderLoading(e){this._submitButton.textContent=e?"Deleting...":this._text}}(c);function q(e){const r=new t({data:e,handleImageClick:()=>{f.open(e.link,e.name)},handleTrashClick:e=>{k.open(),k.setAction((()=>{k.renderLoading(!0),L.deleteCard(e).then((()=>{r.removeCard(),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.renderLoading(!1)}))}))},handleLikeClick:e=>{r.isLiked()?L.unlikeCard(e).then((e=>{r.updateLikes(e.likes)})).catch((e=>{console.log(e)})):L.likeCard(e).then((e=>{r.updateLikes(e.likes)})).catch((e=>{console.log(e)}))}},"#card-template",C);return r.generateCard()}const I=new class{constructor(e){let{nameSelector:t,jobSelector:r,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,job:r}=e;this._nameElement.textContent=t,this._jobElement.textContent=r}setUserAvatar(e){let{avatar:t}=e;this._avatarElement.src=t}}({nameSelector:".profile__name",jobSelector:".profile__name-discription",avatarSelector:".profile__image"}),U=new n(i,(e=>{U.renderLoading(!0),L.sendUserAavatar(e).then((()=>{I.setUserAvatar(e),U.close()})).catch((e=>{console.log(e)})).finally((()=>{U.renderLoading(!1)}))})),w=new n(a,(e=>{w.renderLoading(!0),L.sendUserInfo(e).then((()=>{I.setUserInfo({name:e.name,job:e.job}),w.close()})).catch((e=>{console.log(e)})).finally((()=>{w.renderLoading(!1)}))})),B=new n(o,(e=>{B.renderLoading(!0),L.sendNewCard(e).then((e=>{const t=q(e);h.prepend(t),B.close(),m.reset(),T.resetValidationError()})).catch((e=>{console.log(e)})).finally((()=>{B.renderLoading(!1)}))}));w.setEventListeners(),B.setEventListeners(),f.setEventListeners(),k.setEventListeners(),U.setEventListeners(),S.addEventListener("click",(()=>{var e;e=I.getUserInfo(),y.value=e.avatar,U.open()})),d.addEventListener("click",(()=>{var e;e=I.getUserInfo(),v.value=e.name,g.value=e.job,y.value=e.avatar,w.open()})),_.addEventListener("click",(()=>{B.open()}));const x=new r(b,p),j=new r(b,u),T=new r(b,m);x.enableValidation(),j.enableValidation(),T.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Z0IsR0FBZ0JQLElBQ3JENEYsRUFBYXpGLGVBQWMsR0FDM0IrQixFQUNHZ0IsWUFBWWxELEdBQ1oyQixNQUFNc0QsSUFDTCxNQUFNWSxFQUFlOUIsRUFBV2tCLEdBQ2hDckUsRUFBY3JILFFBQVFzTSxHQUN0QkQsRUFBYS9HLFFBQ2JrQyxFQUFRK0UsUUFDUkMsRUFBaUJsSSwwQkFFbEJzRyxPQUFPQyxJQUNOQyxRQUFRQyxJQUFJRixNQUViYyxTQUFRLEtBQ1BVLEVBQWF6RixlQUFjLFNBSWpDd0YsRUFBaUJ4RyxvQkFDakJ5RyxFQUFhekcsb0JBQ2JvRixFQUFnQnBGLG9CQUNoQjBGLEVBQWlCMUYsb0JBQ2pCc0csRUFBZ0J0RyxvQkFZaEJpQyxFQUFZdEYsaUJBQWlCLFNBQVMsS0FKdEMsSUFBd0JrSyxJQUtIaEMsRUFBWXpCLGNBSi9CcEIsRUFBWWpCLE1BQVE4RixFQUFLaEQsT0FRekJ5QyxFQUFnQnhHLFVBR2xCeUIsRUFBa0I1RSxpQkFBaUIsU0FBUyxLQWxCNUMsSUFBMEJrSyxJQW1CTGhDLEVBQVl6QixjQWxCL0J0QixFQUFVZixNQUFROEYsRUFBS2pNLEtBQ3ZCbUgsRUFBU2hCLE1BQVE4RixFQUFLbEQsSUFDdEIzQixFQUFZakIsTUFBUThGLEVBQUtoRCxPQW9CekIyQyxFQUFpQjFHLFVBR25CMEIsRUFBaUI3RSxpQkFBaUIsU0FBUyxLQUN6QzhKLEVBQWEzRyxVQUdmLE1BQU1nSCxFQUFzQixJQUFJQyxFQUFjN0UsRUFBZUwsR0FDdkRtRixFQUFvQixJQUFJRCxFQUFjN0UsRUFBZVAsR0FDckRpRixFQUFtQixJQUFJRyxFQUFjN0UsRUFBZU4sR0FFMURrRixFQUFvQjFILG1CQUNwQjRILEVBQWtCNUgsbUJBQ2xCd0gsRUFBaUJ4SCxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvY2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtZm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL2FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtaW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1zdWJtaXQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvdXNlci1pbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5ID0gZGF0YTtcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lclNlbGVjdG9yO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faW5pdGlhbEFycmF5LmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cbiIsIi8vLyBDbGFzc2VzIC8vL1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBkYXRhLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVUcmFzaENsaWNrLCBoYW5kbGVMaWtlQ2xpY2sgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgdXNlcklkXG4gICkge1xuICAgIHRoaXMuX3RleHQgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5faW1hZ2UgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fb3duZXIgPSBkYXRhLm93bmVyO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG5cbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrID0gaGFuZGxlVHJhc2hDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cblxuICBfZ2V0VGVtcGxhdGUoKSB7XG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZFwiKTtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLWltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLXBsYWNlXCIpO1xuICAgIGNvbnN0IGxpa2VDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC1saWtlX2NvdW50ZXJcIlxuICAgICk7XG4gICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5nYWxsZXJ5X19jYXJkLXRyYXNoLWJ1dHRvblwiXG4gICAgKTtcblxuICAgIGNhcmRJbWFnZS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7dGhpcy5faW1hZ2V9KWA7XG4gICAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcblxuICAgIGlmICh0aGlzLl9vd25lci5faWQgIT09IHRoaXMuX3VzZXJJZCkge1xuICAgICAgdHJhc2hCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImdhbGxlcnlfX2NhcmQtdHJhc2gtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9idXR0b25cIlxuICAgICk7XG4gICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5nYWxsZXJ5X19jYXJkLXRyYXNoLWJ1dHRvblwiXG4gICAgKTtcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1pbWFnZVwiKTtcblxuICAgIGNhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlSW1hZ2VDbGljaygpKTtcblxuICAgIGxpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzLl9pZCkpO1xuXG4gICAgdHJhc2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVUcmFzaENsaWNrKHRoaXMuX2lkKVxuICAgICk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChwZXJzb24pID0+IHBlcnNvbi5faWQgPT09IHRoaXMuX3VzZXJJZCk7XG4gIH1cblxuICB1cGRhdGVMaWtlcyhsaWtlcykge1xuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC1saWtlX2J1dHRvblwiXG4gICAgKTtcbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9jb3VudGVyXCJcbiAgICApO1xuICAgIGxpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuXG4gICAgaWYgKHRoaXMuaXNMaWtlZCgpKSB7XG4gICAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJnYWxsZXJ5X19jYXJkLWxpa2VfYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiZ2FsbGVyeV9fY2FyZC1saWtlX2J1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgcmVtb3ZlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG59XG4iLCIvLy8gRm9ybVZhbGlkYXRvciAvLy9cbmNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2VsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcblxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb25FcnJvcigpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldmVudCkgPT4ge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5jbGFzc0xpc3QuYWRkKFwicG9wdXBfZmFkZWluXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX2ZhZGVpblwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJjbG9zZS1idXR0b25cIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChldnQpID0+IHtcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9wb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2J1dHRvblwiKTtcbiAgICB0aGlzLl9idXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtU2VsZWN0b3IucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKVxuICAgICk7XG5cbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKVxuICAgICk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2J1dHRvblRleHQ7XG4gICAgfVxuICB9XG59XG4iLCIvLy8vLyBwb3B1cHMvLy8vXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhck1vZHVsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXZhdGFyXCIpO1xuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlTW9kdWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0XCIpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2R1bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkZFwiKTtcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZVwiKTtcbmV4cG9ydCBjb25zdCBkZWxldGVQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGVsZXRlXCIpO1xuXG4vLy8vL2J1dHRvbnMvLy9cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZVBvcHVwQ2xvc2VCdXR0b24gPSBlZGl0UHJvZmlsZU1vZHVsZS5xdWVyeVNlbGVjdG9yKFxuICBcIi5lZGl0X19jbG9zZS1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRQb3B1cENsb3NlQnV0dG9uID1cbiAgYWRkQ2FyZE1vZHVsZS5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fY2xvc2UtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXBDbG9zZUJ1dHRvbiA9IGltYWdlUG9wdXAucXVlcnlTZWxlY3RvcihcbiAgXCIuaW1hZ2VfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuXG4vLy8vIFdyYWFwZXJzIC8vLy8vXG5leHBvcnQgY29uc3QgY2FyZHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdhbGxlcnktY29udGFpbmVyXCIpO1xuZXhwb3J0IGNvbnN0IGNhcmRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NvbnRhaW5lclwiKTtcblxuLy8vLy8gRm9ybXMgLy8vL1xuZXhwb3J0IGNvbnN0IGVkaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5lZGl0X19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGFkZEZvcm0gPSBhZGRDYXJkTW9kdWxlLnF1ZXJ5U2VsZWN0b3IoXCIuYWRkX19mb3JtXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmF2YXRhcl9fZm9ybVwiKTtcblxuLy9JbnB1dHMvL1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBqb2JJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiam9iLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhcklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXItaW5wdXRcIik7XG5cbi8vIENvbnN0IEVsZW1lbnRzIC8vXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZS1kaXNjcmlwdGlvblwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XG5cbi8vLyBDYXJkIFJlbmRlcmluZyAgLy8vXG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICB0ZXh0OiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGV4dDogXCJMYWtlIExvdWlzZVwiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGV4dDogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGV4dDogXCJMYXRlbWFyXCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRleHQ6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRleHQ6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXG59O1xuIiwiY29uc3QgY3VzdG9tRmV0Y2ggPSAodXJsLCBoZWFkZXIpID0+XG4gIGZldGNoKHVybCwgaGVhZGVyKS50aGVuKChyZXMpID0+XG4gICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBTb21ldGhpbmcgd2VudCB3cm9uZzogJHtyZXMuc3RhdHVzfWApXG4gICk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgc2VuZFVzZXJJbmZvKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLFxuICAgICAgICBhYm91dDogaW5wdXRWYWx1ZXMuam9iLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBzZW5kVXNlckFhdmF0YXIoaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGlucHV0VmFsdWVzLmF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBzZW5kTmV3Q2FyZChpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBpbnB1dFZhbHVlcy50aXRsZSxcbiAgICAgICAgbGluazogaW5wdXRWYWx1ZXMuaW1hZ2UsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5cbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvc2VjdGlvbi5qc1wiO1xuXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL2NhcmQuanNcIjtcblxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9mb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmltcG9ydCBQb3B1cFdpdGhTdWJtaXQgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLXN1Ym1pdC5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtZm9ybS5qc1wiO1xuXG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1pbWFnZS5qc1wiO1xuXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy91c2VyLWluZm8uanNcIjtcblxuaW1wb3J0IHtcbiAgZGVmYXVsdENvbmZpZyxcbiAgY2FyZENvbnRhaW5lcixcbiAgYXZhdGFySW1hZ2UsXG4gIGF2YXRhckZvcm0sXG4gIGFkZEZvcm0sXG4gIGVkaXRGb3JtLFxuICBlZGl0QXZhdGFyTW9kdWxlLFxuICBlZGl0UHJvZmlsZU1vZHVsZSxcbiAgYWRkQ2FyZE1vZHVsZSxcbiAgcHJvZmlsZUFkZEJ1dHRvbixcbiAgcHJvZmlsZUVkaXRCdXR0b24sXG4gIG5hbWVJbnB1dCxcbiAgam9iSW5wdXQsXG4gIGF2YXRhcklucHV0LFxuICBpbWFnZVBvcHVwLFxuICBkZWxldGVQb3B1cCxcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9hcGkuanNcIjtcblxuLy8vIGFwaXMgYW5kIGluaXRpYWwgbG9hZFxuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjZhODVhMzc3LWU3NmUtNGU3Mi04NWE5LTc5ZWU1MjA4ZTM2YVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmxldCB1c2VySWQ7XG5cblByb21pc2UuYWxsKFthcGkuZ2V0SW5pdGlhbENhcmRzKCksIGFwaS5nZXRVc2VySW5mbygpXSlcbiAgLnRoZW4oKFtjYXJkRGF0YSwgdXNlckRhdGFdKSA9PiB7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgIGNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKFxuICAgICAge1xuICAgICAgICBkYXRhOiBjYXJkRGF0YSxcbiAgICAgICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuXG4gICAgICAgICAgY2FyZHNMaXN0LmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIGNhcmRDb250YWluZXJcbiAgICApO1xuXG4gICAgY2FyZHNMaXN0LnJlbmRlckl0ZW1zKCk7XG5cbiAgICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7XG4gICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxuICAgICAgam9iOiB1c2VyRGF0YS5hYm91dCxcbiAgICB9KTtcblxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJBdmF0YXIoe1xuICAgICAgYXZhdGFyOiB1c2VyRGF0YS5hdmF0YXIsXG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyKTtcbiAgfSk7XG5cbmNvbnN0IGltYWdlUG9wdXBNb2RsZSA9IG5ldyBQb3B1cFdpdGhJbWFnZShpbWFnZVBvcHVwKTtcbmNvbnN0IGRlbGV0ZVBvcHVwTW9kbGUgPSBuZXcgUG9wdXBXaXRoU3VibWl0KGRlbGV0ZVBvcHVwKTtcblxuLy8vIGluaXRpYWwgbG9hZCBmdW5jdGlvbnMgLy8vXG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxuICAgIHtcbiAgICAgIGRhdGE6IGNhcmREYXRhLFxuICAgICAgaGFuZGxlSW1hZ2VDbGljazogKCkgPT4ge1xuICAgICAgICBpbWFnZVBvcHVwTW9kbGUub3BlbihjYXJkRGF0YS5saW5rLCBjYXJkRGF0YS5uYW1lKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVUcmFzaENsaWNrOiAoaWQpID0+IHtcbiAgICAgICAgZGVsZXRlUG9wdXBNb2RsZS5vcGVuKCk7XG4gICAgICAgIGRlbGV0ZVBvcHVwTW9kbGUuc2V0QWN0aW9uKCgpID0+IHtcbiAgICAgICAgICBkZWxldGVQb3B1cE1vZGxlLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICAgICAgYXBpXG4gICAgICAgICAgICAuZGVsZXRlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XG4gICAgICAgICAgICAgIGRlbGV0ZVBvcHVwTW9kbGUuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgICAgZGVsZXRlUG9wdXBNb2RsZS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVMaWtlQ2xpY2s6IChpZCkgPT4ge1xuICAgICAgICBjb25zdCBhbHJlYWR5TGlrZWQgPSBjYXJkLmlzTGlrZWQoKTtcblxuICAgICAgICBpZiAoYWxyZWFkeUxpa2VkKSB7XG4gICAgICAgICAgYXBpXG4gICAgICAgICAgICAudW5saWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5saWtlQ2FyZChpZClcbiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgICAgY2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICB1c2VySWRcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbi8vLyBGb3JtIEZ1bmN0aW9ucyAvLy9cblxuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWUtZGlzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdEF2YXRhck1vZHVsZSwgKGlucHV0VmFsdWUpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5zZW5kVXNlckFhdmF0YXIoaW5wdXRWYWx1ZSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBwcm9maWxlSW5mby5zZXRVc2VyQXZhdGFyKGlucHV0VmFsdWUpO1xuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn0pO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdFByb2ZpbGVNb2R1bGUsIChpbnB1dFZhbHVlcykgPT4ge1xuICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5zZW5kVXNlckluZm8oaW5wdXRWYWx1ZXMpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oeyBuYW1lOiBpbnB1dFZhbHVlcy5uYW1lLCBqb2I6IGlucHV0VmFsdWVzLmpvYiB9KTtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn0pO1xuXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShhZGRDYXJkTW9kdWxlLCAoaW5wdXRWYWx1ZXMpID0+IHtcbiAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5zZW5kTmV3Q2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZHNFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkKTtcbiAgICAgIGNhcmRDb250YWluZXIucHJlcGVuZChjYXJkc0VsZW1lbnQpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICBhZGRGb3JtLnJlc2V0KCk7XG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn0pO1xuXG5lZGl0UHJvZmlsZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmltYWdlUG9wdXBNb2RsZS5zZXRFdmVudExpc3RlbmVycygpO1xuZGVsZXRlUG9wdXBNb2RsZS5zZXRFdmVudExpc3RlbmVycygpO1xuZWRpdEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGZpbGxVc2VySW5mb0Zvcm0oaW5mbykge1xuICBuYW1lSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XG4gIGpvYklucHV0LnZhbHVlID0gaW5mby5qb2I7XG4gIGF2YXRhcklucHV0LnZhbHVlID0gaW5mby5hdmF0YXI7XG59XG5cbmZ1bmN0aW9uIGZpbGxBdmF0YXJGb3JtKGluZm8pIHtcbiAgYXZhdGFySW5wdXQudmFsdWUgPSBpbmZvLmF2YXRhcjtcbn1cblxuYXZhdGFySW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgZm9ybUlucHV0cyA9IHByb2ZpbGVJbmZvLmdldFVzZXJJbmZvKCk7XG5cbiAgZmlsbEF2YXRhckZvcm0oZm9ybUlucHV0cyk7XG5cbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBmb3JtSW5wdXRzID0gcHJvZmlsZUluZm8uZ2V0VXNlckluZm8oKTtcblxuICBmaWxsVXNlckluZm9Gb3JtKGZvcm1JbnB1dHMpO1xuXG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xufSk7XG5cbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5jb25zdCBhdmF0YXJGcm9tVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZGVmYXVsdENvbmZpZywgYXZhdGFyRm9ybSk7XG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGRlZmF1bHRDb25maWcsIGVkaXRGb3JtKTtcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihkZWZhdWx0Q29uZmlnLCBhZGRGb3JtKTtcblxuYXZhdGFyRnJvbVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9wb3B1cC5qc1wiO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIG9wZW4oaW1hZ2UsIHRleHQpIHtcbiAgICBjb25zdCBpbWFnZVBvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2VfX3BvcHVwXCIpO1xuICAgIGNvbnN0IGltYWdlUG9wdXBEZWNyaXB0aW9uID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuaW1hZ2VfX2Rpc2NyaXB0aW9uXCJcbiAgICApO1xuICAgIGltYWdlUG9wdXBJbWFnZS5zcmMgPSBpbWFnZTtcbiAgICBpbWFnZVBvcHVwSW1hZ2UuYWx0ID0gdGV4dDtcbiAgICBpbWFnZVBvcHVwRGVjcmlwdGlvbi50ZXh0Q29udGVudCA9IHRleHQ7XG5cbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9wb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBwb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBwb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIuYnV0dG9uXCIpO1xuICAgIHRoaXMuX3RleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRBY3Rpb24oYWN0aW9uKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCgpO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJjb250YWluZXJTZWxlY3RvciIsImRhdGEiLCJyZW5kZXJlciIsInRoaXMiLCJfaW5pdGlhbEFycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJDYXJkIiwiY2FyZFNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfdGV4dCIsIm5hbWUiLCJfaW1hZ2UiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfaWQiLCJfb3duZXIiLCJvd25lciIsIl9jYXJkU2VsZWN0b3IiLCJfdXNlcklkIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlVHJhc2hDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiX2VsZW1lbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJjYXJkSW1hZ2UiLCJjYXJkVGl0bGUiLCJ0cmFzaEJ1dHRvbiIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJfcmVuZGVyTGlrZXMiLCJsaWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlzTGlrZWQiLCJzb21lIiwicGVyc29uIiwidXBkYXRlTGlrZXMiLCJsZW5ndGgiLCJhZGQiLCJyZW1vdmVDYXJkIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb25FcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImUiLCJrZXkiLCJjbG9zZSIsIl9wb3B1cFNlbGVjdG9yIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybVNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsIl9idXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImVkaXRBdmF0YXJNb2R1bGUiLCJlZGl0UHJvZmlsZU1vZHVsZSIsImFkZENhcmRNb2R1bGUiLCJpbWFnZVBvcHVwIiwiZGVsZXRlUG9wdXAiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJjYXJkQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJhdmF0YXJGb3JtIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsImF2YXRhckltYWdlIiwiZGVmYXVsdENvbmZpZyIsImZvcm1TZWxlY3RvciIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldFVzZXJJbmZvIiwic2VuZFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImpvYiIsInNlbmRVc2VyQWF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsInNlbmROZXdDYXJkIiwidGl0bGUiLCJpbWFnZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiYWxsIiwiY2FyZERhdGEiLCJ1c2VyRGF0YSIsImNhcmRzTGlzdCIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsInByb2ZpbGVJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiaW1hZ2VQb3B1cE1vZGxlIiwidGV4dCIsImltYWdlUG9wdXBJbWFnZSIsImltYWdlUG9wdXBEZWNyaXB0aW9uIiwic3JjIiwiYWx0IiwiZGVsZXRlUG9wdXBNb2RsZSIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJjYXJkIiwiZmluYWxseSIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZWRpdEF2YXRhclBvcHVwIiwiaW5wdXRWYWx1ZSIsImVkaXRQcm9maWxlUG9wdXAiLCJhZGRDYXJkUG9wdXAiLCJjYXJkc0VsZW1lbnQiLCJyZXNldCIsImFkZEZvcm1WYWxpZGF0b3IiLCJpbmZvIiwiYXZhdGFyRnJvbVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=