!function(){"use strict";class e{constructor(e,t){let{data:r,renderer:s}=e;this._initialArray=r,this._renderer=s,this._container=t}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class t{constructor(e,t,r){let{data:s,handleImageClick:n,handleTrashClick:i,handleLikeClick:a}=e;this._text=s.name,this._image=s.link,this._likes=s.likes,this._id=s._id,this._cardSelector=t,this._userId=r,this._handleImageClick=n,this._handleTrashClick=i,this._handleLikeClick=a}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".gallery__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".gallery__card-image"),t=this._element.querySelector(".gallery__card-place"),r=this._element.querySelector(".gallery__card-like_counter");return e.style.backgroundImage="url(".concat(this._image,")"),t.textContent=this._text,r.textContent=this._likes.length,this._likes.some((e=>e._id===this._userId))&&this.likeCard(this._likes),this._element}_setEventListeners(){const e=this._element.querySelector(".gallery__card-like_button"),t=this._element.querySelector(".gallery__card-trash-button");this._element.querySelector(".gallery__card-image").addEventListener("click",(()=>this._handleImageClick())),e.addEventListener("click",(()=>this._handleLikeClick(this._id))),t.addEventListener("click",(()=>this._handleTrashClick(this._id)))}isLiked(){return this._likes.some((e=>e._id===this._userId))}likeCard(e){this._likes=e;const t=this._element.querySelector(".gallery__card-like_button");this._element.querySelector(".gallery__card-like_counter").textContent=this._likes.length,t.classList.toggle("gallery__card-like_button_active")}removeCard(){this._element.remove(),this._element=null}}var r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector)}_showInputError(e,t){const r=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),r.textContent=t,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){var t,r;r=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._popupSelector=e,this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_fadein"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_fadein"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupSelector.addEventListener("click",(e=>{e.target.classList.contains("close-button")&&this.close()})),this._popupSelector.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".form__button")}_getInputValues(){const e=Array.from(this._formSelector.querySelectorAll(".form__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formSelector.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}renderLoading(e){e?this._submitButton.textContent="Saving...":this._submitButton.classList.contains("form__button-create")?this._submitButton.textContent="Create":this._submitButton.textContent="Save"}}const i=document.querySelector(".avatar"),a=document.querySelector(".edit"),o=document.querySelector(".add"),l=document.querySelector(".image"),c=document.querySelector(".delete"),d=document.querySelector(".profile__edit-button"),_=(a.querySelector(".edit__close-button"),document.querySelector(".profile__add-button")),u=(o.querySelector(".add__close-button"),l.querySelector(".image__close-button"),document.getElementById("gallery-container"),document.querySelector(".gallery__container")),h=document.querySelector(".edit__form"),m=o.querySelector(".add__form"),p=document.querySelector(".avatar__form"),v=document.getElementById("name-input"),g=document.getElementById("job-input"),y=document.getElementById("avatar-input"),S=(document.querySelector(".profile__name"),document.querySelector(".profile__name-discription"),document.querySelector(".profile__image")),b={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},E=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))).catch((e=>{console.log(e)})),C=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getUserInfo(){return E("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}sendUserInfo(e){return E("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.job})})}sendUserAavatar(e){return E("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}getInitialCards(){return E("".concat(this._baseUrl,"/cards"),{headers:this._headers})}sendNewCard(e){return E("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.image})})}deleteCard(e){return E("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}likeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6a85a377-e76e-4e72-85a9-79ee5208e36a","Content-Type":"application/json"}});let L;Promise.all([C.getInitialCards(),C.getUserInfo()]).then((t=>{let[r,s]=t;L=s._id;const n=new e({data:r,renderer:e=>{const t=q(e);e.owner._id!==L&&t.querySelector(".gallery__card-trash-button").classList.remove("gallery__card-trash-button_active"),n.addItem(t)}},u);n.renderItems(),I.setUserInfo({name:s.name,job:s.about}),I.setUserAvatar({avatar:s.avatar})}));const f=new class extends s{open(e,t){const r=this._popupSelector.querySelector(".image__popup"),s=this._popupSelector.querySelector(".image__discription");r.src=e,r.alt=t,s.textContent=t,super.open()}}(l),k=new class extends s{constructor(e){super(e),this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".delete__button")}setAction(e){this._submitHandler=e}setEventListeners(){this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}renderLoading(e){this._submitButton.textContent=e?"Deleting...":"Yes"}}(c);function q(e){const r=new t({data:e,handleImageClick:()=>{f.open(e.link,e.name)},handleTrashClick:e=>{k.open(),k.setAction((()=>{k.renderLoading(!0),C.deleteCard(e).finally((()=>{k.renderLoading(!1),r.removeCard(),k.close()}))}))},handleLikeClick:e=>{r.isLiked()?C.unlikeCard(e).then((e=>{r.likeCard(e.likes)})):C.likeCard(e).then((e=>{r.likeCard(e.likes)}))}},"#card-template",L);return r.generateCard()}const I=new class{constructor(e){let{nameSelector:t,jobSelector:r,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,job:r}=e;this._nameElement.textContent=t,this._jobElement.textContent=r}setUserAvatar(e){let{avatar:t}=e;this._avatarElement.src=t}}({nameSelector:".profile__name",jobSelector:".profile__name-discription",avatarSelector:".profile__image"}),U=new n(i,(e=>{U.renderLoading(!0),C.sendUserAavatar(e).finally((()=>{U.renderLoading(!1),I.setUserAvatar(e),U.close()}))})),B=new n(a,(e=>{B.renderLoading(!0),C.sendUserInfo(e).finally((()=>{B.renderLoading(!1),I.setUserInfo({name:e.name,job:e.job}),B.close()}))})),w=new n(o,(e=>{w.renderLoading(!0),console.log("is Loading"),C.sendNewCard(e).then((e=>{const t=q(e);u.prepend(t)})).finally((()=>{w.renderLoading(!1),w.close(),m.reset(),T.resetValidationError()}))}));function x(e){v.value=e.name,g.value=e.job,y.value=e.avatar}B.setEventListeners(),w.setEventListeners(),f.setEventListeners(),k.setEventListeners(),U.setEventListeners(),S.addEventListener("click",(()=>{x(I.getUserInfo()),U.open()})),d.addEventListener("click",(()=>{x(I.getUserInfo()),B.open()})),_.addEventListener("click",(()=>{w.open()}));const j=new r(b,p),A=new r(b,h),T=new r(b,m);j.enableValidation(),A.enableValidation(),T.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJqSSw2QkFVdkIsU0FBU2tJLEVBQWFDLEdBQ3BCaEYsRUFBVWYsTUFBUStGLEVBQUtqTSxLQUN2QmtILEVBQVNoQixNQUFRK0YsRUFBSy9DLElBQ3RCL0IsRUFBWWpCLE1BQVErRixFQUFLN0MsT0FUM0J1QyxFQUFpQnZHLG9CQUNqQndHLEVBQWF4RyxvQkFDYm1GLEVBQWdCbkYsb0JBQ2hCeUYsRUFBaUJ6RixvQkFDakJxRyxFQUFnQnJHLG9CQVFoQmdDLEVBQVlyRixpQkFBaUIsU0FBUyxLQUdwQ2lLLEVBRm1CNUIsRUFBWXpCLGVBSS9COEMsRUFBZ0J2RyxVQUdsQndCLEVBQWtCM0UsaUJBQWlCLFNBQVMsS0FHMUNpSyxFQUZtQjVCLEVBQVl6QixlQUkvQmdELEVBQWlCekcsVUFHbkJ5QixFQUFpQjVFLGlCQUFpQixTQUFTLEtBQ3pDNkosRUFBYTFHLFVBR2YsTUFBTWdILEVBQXNCLElBQUlDLEVBQWM5RSxFQUFlTCxHQUN2RG9GLEVBQW9CLElBQUlELEVBQWM5RSxFQUFlUCxHQUNyRGlGLEVBQW1CLElBQUlJLEVBQWM5RSxFQUFlTixHQUUxRG1GLEVBQW9CMUgsbUJBQ3BCNEgsRUFBa0I1SCxtQkFDbEJ1SCxFQUFpQnZILG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9jYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL2Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1mb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvYXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1pbWFnZS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLXN1Ym1pdC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy91c2VyLWluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgZGF0YSwgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkgPSBkYXRhO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyU2VsZWN0b3I7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pbml0aWFsQXJyYXkuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiLy8vIENsYXNzZXMgLy8vXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IGRhdGEsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZVRyYXNoQ2xpY2ssIGhhbmRsZUxpa2VDbGljayB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICB1c2VySWRcbiAgKSB7XG4gICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZSA9IGRhdGEubGluaztcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmRcIik7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1wbGFjZVwiKTtcbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9jb3VudGVyXCJcbiAgICApO1xuXG4gICAgY2FyZEltYWdlLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJHt0aGlzLl9pbWFnZX0pYDtcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xuICAgIGxpa2VDb3VudGVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xuXG4gICAgY29uc3QgaXNMaWtlZCA9IHRoaXMuX2xpa2VzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcblxuICAgIGlmIChpc0xpa2VkKSB7XG4gICAgICB0aGlzLmxpa2VDYXJkKHRoaXMuX2xpa2VzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC1saWtlX2J1dHRvblwiXG4gICAgKTtcbiAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtdHJhc2gtYnV0dG9uXCJcbiAgICApO1xuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkLWltYWdlXCIpO1xuXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKCkpO1xuXG4gICAgbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMuX2lkKSk7XG5cbiAgICB0cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZVRyYXNoQ2xpY2sodGhpcy5faWQpXG4gICAgKTtcbiAgfVxuXG4gIGlzTGlrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLnNvbWUoKHBlcnNvbikgPT4gcGVyc29uLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcbiAgfVxuXG4gIGxpa2VDYXJkKG5ld0xpa2VzKSB7XG4gICAgdGhpcy5fbGlrZXMgPSBuZXdMaWtlcztcbiAgICBjb25zdCBsaWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC1saWtlX2J1dHRvblwiXG4gICAgKTtcbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9jb3VudGVyXCJcbiAgICApO1xuXG4gICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG5cbiAgICBsaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJnYWxsZXJ5X19jYXJkLWxpa2VfYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxufVxuIiwiLy8vIEZvcm1WYWxpZGF0b3IgLy8vXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9lbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uRXJyb3IoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcblxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LmFkZChcInBvcHVwX2ZhZGVpblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9mYWRlaW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2xvc2UtYnV0dG9uXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vcG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1TZWxlY3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpXG4gICAgKTtcblxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG5cbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2Zvcm1TZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpXG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJmb3JtX19idXR0b24tY3JlYXRlXCIpKSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQ3JlYXRlXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsIi8vLy8vIHBvcHVwcy8vLy9cbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyTW9kdWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hdmF0YXJcIik7XG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVNb2R1bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXRcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZHVsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkXCIpO1xuZXhwb3J0IGNvbnN0IGltYWdlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlXCIpO1xuZXhwb3J0IGNvbnN0IGRlbGV0ZVBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5kZWxldGVcIik7XG5cbi8vLy8vYnV0dG9ucy8vL1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlUG9wdXBDbG9zZUJ1dHRvbiA9IGVkaXRQcm9maWxlTW9kdWxlLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmVkaXRfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5leHBvcnQgY29uc3QgY2FyZFBvcHVwQ2xvc2VCdXR0b24gPVxuICBhZGRDYXJkTW9kdWxlLnF1ZXJ5U2VsZWN0b3IoXCIuYWRkX19jbG9zZS1idXR0b25cIik7XG5leHBvcnQgY29uc3QgaW1hZ2VQb3B1cENsb3NlQnV0dG9uID0gaW1hZ2VQb3B1cC5xdWVyeVNlbGVjdG9yKFxuICBcIi5pbWFnZV9fY2xvc2UtYnV0dG9uXCJcbik7XG5cbi8vLy8gV3JhYXBlcnMgLy8vLy9cbmV4cG9ydCBjb25zdCBjYXJkc0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FsbGVyeS1jb250YWluZXJcIik7XG5leHBvcnQgY29uc3QgY2FyZENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY29udGFpbmVyXCIpO1xuXG4vLy8vLyBGb3JtcyAvLy8vXG5leHBvcnQgY29uc3QgZWRpdEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXRfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgYWRkRm9ybSA9IGFkZENhcmRNb2R1bGUucXVlcnlTZWxlY3RvcihcIi5hZGRfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYXZhdGFyX19mb3JtXCIpO1xuXG4vL0lucHV0cy8vXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IGpvYklucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJqb2ItaW5wdXRcIik7XG5leHBvcnQgY29uc3QgYXZhdGFySW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2YXRhci1pbnB1dFwiKTtcblxuLy8gQ29uc3QgRWxlbWVudHMgLy9cbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lLWRpc2NyaXB0aW9uXCIpO1xuZXhwb3J0IGNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcblxuLy8vIENhcmQgUmVuZGVyaW5nICAvLy9cblxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIHRleHQ6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0ZXh0OiBcIkxha2UgTG91aXNlXCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0ZXh0OiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0ZXh0OiBcIkxhdGVtYXJcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGV4dDogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgdGV4dDogXCJMYWdvIGRpIEJyYWllc1wiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcbn07XG4iLCJjb25zdCBjdXN0b21GZXRjaCA9ICh1cmwsIGhlYWRlcikgPT5cbiAgZmV0Y2godXJsLCBoZWFkZXIpXG4gICAgLnRoZW4oKHJlcykgPT5cbiAgICAgIHJlcy5va1xuICAgICAgICA/IHJlcy5qc29uKClcbiAgICAgICAgOiBQcm9taXNlLnJlamVjdChgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7cmVzLnN0YXR1c31gKVxuICAgIClcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBzZW5kVXNlckluZm8oaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsXG4gICAgICAgIGFib3V0OiBpbnB1dFZhbHVlcy5qb2IsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIHNlbmRVc2VyQWF2YXRhcihpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogaW5wdXRWYWx1ZXMuYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIHNlbmROZXdDYXJkKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLFxuICAgICAgICBsaW5rOiBpbnB1dFZhbHVlcy5pbWFnZSxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvbGlrZXMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcblxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9zZWN0aW9uLmpzXCI7XG5cbmltcG9ydCBDYXJkIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvY2FyZC5qc1wiO1xuXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL2Zvcm1WYWxpZGF0b3IuanNcIjtcblxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtc3VibWl0LmpzXCI7XG5cbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1mb3JtLmpzXCI7XG5cbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLWltYWdlLmpzXCI7XG5cbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL3VzZXItaW5mby5qc1wiO1xuXG5pbXBvcnQge1xuICBkZWZhdWx0Q29uZmlnLFxuICBjYXJkQ29udGFpbmVyLFxuICBhdmF0YXJJbWFnZSxcbiAgYXZhdGFyRm9ybSxcbiAgYWRkRm9ybSxcbiAgZWRpdEZvcm0sXG4gIGVkaXRBdmF0YXJNb2R1bGUsXG4gIGVkaXRQcm9maWxlTW9kdWxlLFxuICBhZGRDYXJkTW9kdWxlLFxuICBwcm9maWxlQWRkQnV0dG9uLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgbmFtZUlucHV0LFxuICBqb2JJbnB1dCxcbiAgYXZhdGFySW5wdXQsXG4gIGltYWdlUG9wdXAsXG4gIGRlbGV0ZVBvcHVwLFxufSBmcm9tIFwiLi4vc2NyaXB0cy91dGlscy9jb25zdGFudHMuanNcIjtcblxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL2FwaS5qc1wiO1xuXG4vLy8gYXBpcyBhbmQgaW5pdGlhbCBsb2FkXG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNmE4NWEzNzctZTc2ZS00ZTcyLTg1YTktNzllZTUyMDhlMzZhXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxubGV0IHVzZXJJZDtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKS50aGVuKFxuICAoW2NhcmREYXRhLCB1c2VyRGF0YV0pID0+IHtcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XG4gICAgY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGRhdGE6IGNhcmREYXRhLFxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG5cbiAgICAgICAgICBpZiAoaXRlbS5vd25lci5faWQgIT09IHVzZXJJZCkge1xuICAgICAgICAgICAgY29uc3QgdHJhc2hCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgICAgICBcIi5nYWxsZXJ5X19jYXJkLXRyYXNoLWJ1dHRvblwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdHJhc2hCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImdhbGxlcnlfX2NhcmQtdHJhc2gtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY2FyZENvbnRhaW5lclxuICAgICk7XG5cbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoKTtcblxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBqb2I6IHVzZXJEYXRhLmFib3V0LFxuICAgIH0pO1xuXG4gICAgcHJvZmlsZUluZm8uc2V0VXNlckF2YXRhcih7XG4gICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcixcbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3QgaW1hZ2VQb3B1cE1vZGxlID0gbmV3IFBvcHVwV2l0aEltYWdlKGltYWdlUG9wdXApO1xuY29uc3QgZGVsZXRlUG9wdXBNb2RsZSA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoZGVsZXRlUG9wdXApO1xuXG4vLy8gaW5pdGlhbCBsb2FkIGZ1bmN0aW9ucyAvLy9cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YTogY2FyZERhdGEsXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoKSA9PiB7XG4gICAgICAgIGltYWdlUG9wdXBNb2RsZS5vcGVuKGNhcmREYXRhLmxpbmssIGNhcmREYXRhLm5hbWUpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZVRyYXNoQ2xpY2s6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVQb3B1cE1vZGxlLm9wZW4oKTtcbiAgICAgICAgZGVsZXRlUG9wdXBNb2RsZS5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIGRlbGV0ZVBvcHVwTW9kbGUucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICBhcGkuZGVsZXRlQ2FyZChpZCkuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVQb3B1cE1vZGxlLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XG4gICAgICAgICAgICBkZWxldGVQb3B1cE1vZGxlLmNsb3NlKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZUxpa2VDbGljazogKGlkKSA9PiB7XG4gICAgICAgIGNvbnN0IGFscmVhZHlMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xuXG4gICAgICAgIGlmIChhbHJlYWR5TGlrZWQpIHtcbiAgICAgICAgICBhcGkudW5saWtlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XG4gICAgICAgICAgICBjYXJkLmxpa2VDYXJkKHJlcy5saWtlcyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXBpLmxpa2VDYXJkKGlkKS50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQubGlrZUNhcmQocmVzLmxpa2VzKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9LFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgICB1c2VySWRcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XG59XG5cbi8vLyBGb3JtIEZ1bmN0aW9ucyAvLy9cblxuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWUtZGlzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oZWRpdEF2YXRhck1vZHVsZSwgKGlucHV0VmFsdWUpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaS5zZW5kVXNlckFhdmF0YXIoaW5wdXRWYWx1ZSkuZmluYWxseSgoKSA9PiB7XG4gICAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJBdmF0YXIoaW5wdXRWYWx1ZSk7XG4gICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XG4gIH0pO1xufSk7XG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShlZGl0UHJvZmlsZU1vZHVsZSwgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpLnNlbmRVc2VySW5mbyhpbnB1dFZhbHVlcykuZmluYWxseSgoKSA9PiB7XG4gICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsIGpvYjogaW5wdXRWYWx1ZXMuam9iIH0pO1xuICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcbiAgfSk7XG59KTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oYWRkQ2FyZE1vZHVsZSwgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBjb25zb2xlLmxvZyhcImlzIExvYWRpbmdcIik7XG4gIGFwaVxuICAgIC5zZW5kTmV3Q2FyZChpbnB1dFZhbHVlcylcbiAgICAudGhlbigoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZHNFbGVtZW50ID0gY3JlYXRlQ2FyZChjYXJkKTtcbiAgICAgIGNhcmRDb250YWluZXIucHJlcGVuZChjYXJkc0VsZW1lbnQpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgYWRkQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICBhZGRGb3JtLnJlc2V0KCk7XG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbkVycm9yKCk7XG4gICAgfSk7XG59KTtcblxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5pbWFnZVBvcHVwTW9kbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmRlbGV0ZVBvcHVwTW9kbGUuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBmaWxsSW5mb0Zvcm0oaW5mbykge1xuICBuYW1lSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XG4gIGpvYklucHV0LnZhbHVlID0gaW5mby5qb2I7XG4gIGF2YXRhcklucHV0LnZhbHVlID0gaW5mby5hdmF0YXI7XG59XG5cbmF2YXRhckltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGZvcm1JbnB1dHMgPSBwcm9maWxlSW5mby5nZXRVc2VySW5mbygpO1xuXG4gIGZpbGxJbmZvRm9ybShmb3JtSW5wdXRzKTtcblxuICBlZGl0QXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGZvcm1JbnB1dHMgPSBwcm9maWxlSW5mby5nZXRVc2VySW5mbygpO1xuXG4gIGZpbGxJbmZvRm9ybShmb3JtSW5wdXRzKTtcblxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuY29uc3QgYXZhdGFyRnJvbVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGRlZmF1bHRDb25maWcsIGF2YXRhckZvcm0pO1xuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihkZWZhdWx0Q29uZmlnLCBlZGl0Rm9ybSk7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZGVmYXVsdENvbmZpZywgYWRkRm9ybSk7XG5cbmF2YXRhckZyb21WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vcG9wdXAuanNcIjtcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBvcGVuKGltYWdlLCB0ZXh0KSB7XG4gICAgY29uc3QgaW1hZ2VQb3B1cEltYWdlID0gdGhpcy5fcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmltYWdlX19wb3B1cFwiKTtcbiAgICBjb25zdCBpbWFnZVBvcHVwRGVjcmlwdGlvbiA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmltYWdlX19kaXNjcmlwdGlvblwiXG4gICAgKTtcbiAgICBpbWFnZVBvcHVwSW1hZ2Uuc3JjID0gaW1hZ2U7XG4gICAgaW1hZ2VQb3B1cEltYWdlLmFsdCA9IHRleHQ7XG4gICAgaW1hZ2VQb3B1cERlY3JpcHRpb24udGV4dENvbnRlbnQgPSB0ZXh0O1xuXG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vcG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoU3VibWl0IGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gcG9wdXBTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZV9fYnV0dG9uXCIpO1xuICB9XG5cbiAgc2V0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xuICAgIH0pO1xuXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlllc1wiO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJjb250YWluZXJTZWxlY3RvciIsImRhdGEiLCJyZW5kZXJlciIsInRoaXMiLCJfaW5pdGlhbEFycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJDYXJkIiwiY2FyZFNlbGVjdG9yIiwidXNlcklkIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZVRyYXNoQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfdGV4dCIsIm5hbWUiLCJfaW1hZ2UiLCJsaW5rIiwiX2xpa2VzIiwibGlrZXMiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX3VzZXJJZCIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwibGlrZUNvdW50ZXIiLCJzdHlsZSIsImJhY2tncm91bmRJbWFnZSIsInRleHRDb250ZW50IiwibGVuZ3RoIiwic29tZSIsInBlcnNvbiIsImxpa2VDYXJkIiwibGlrZUJ1dHRvbiIsInRyYXNoQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlzTGlrZWQiLCJuZXdMaWtlcyIsImNsYXNzTGlzdCIsInRvZ2dsZSIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJjb25maWciLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2J1dHRvbkVsZW1lbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlc2V0VmFsaWRhdGlvbkVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlZCIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2ZW50IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiZSIsImtleSIsImNsb3NlIiwiX3BvcHVwU2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtU2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImVkaXRBdmF0YXJNb2R1bGUiLCJlZGl0UHJvZmlsZU1vZHVsZSIsImFkZENhcmRNb2R1bGUiLCJpbWFnZVBvcHVwIiwiZGVsZXRlUG9wdXAiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJjYXJkQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJhdmF0YXJGb3JtIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsImF2YXRhckltYWdlIiwiZGVmYXVsdENvbmZpZyIsImZvcm1TZWxlY3RvciIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldFVzZXJJbmZvIiwic2VuZFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImpvYiIsInNlbmRVc2VyQWF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsInNlbmROZXdDYXJkIiwidGl0bGUiLCJpbWFnZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJ1bmxpa2VDYXJkIiwiYXV0aG9yaXphdGlvbiIsImFsbCIsImNhcmREYXRhIiwidXNlckRhdGEiLCJjYXJkc0xpc3QiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJvd25lciIsInByb2ZpbGVJbmZvIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiaW1hZ2VQb3B1cE1vZGxlIiwidGV4dCIsImltYWdlUG9wdXBJbWFnZSIsImltYWdlUG9wdXBEZWNyaXB0aW9uIiwic3JjIiwiYWx0IiwiZGVsZXRlUG9wdXBNb2RsZSIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9zdWJtaXRIYW5kbGVyIiwiY2FyZCIsImZpbmFsbHkiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImVkaXRBdmF0YXJQb3B1cCIsImlucHV0VmFsdWUiLCJlZGl0UHJvZmlsZVBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwiY2FyZHNFbGVtZW50IiwicmVzZXQiLCJhZGRGb3JtVmFsaWRhdG9yIiwiZmlsbEluZm9Gb3JtIiwiaW5mbyIsImF2YXRhckZyb21WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9