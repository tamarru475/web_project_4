!function(){"use strict";class e{constructor(e,t){let{data:r,renderer:s}=e;this._initialArray=r,this._renderer=s,this._container=t}renderItems(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class t{constructor(e,t,r){let{data:s,handleImageClick:n,handleTrashClick:i,handleLikeClick:o}=e;this._text=s.name,this._image=s.link,this._likes=s.likes,this._id=s._id,this._owner=s.owner,this._cardSelector=t,this._userId=r,this._handleImageClick=n,this._handleTrashClick=i,this._handleLikeClick=o}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".gallery__card").cloneNode(!0)}generateCard(){this._element=this._getTemplate(),this._setEventListeners();const e=this._element.querySelector(".gallery__card-image"),t=this._element.querySelector(".gallery__card-place"),r=this._element.querySelector(".gallery__card-like_counter"),s=this._element.querySelector(".gallery__card-trash-button");return e.style.backgroundImage="url(".concat(this._image,")"),t.textContent=this._text,r.textContent=this._likes.length,this._owner._id!==this._userId&&s.classList.remove("gallery__card-trash-button_active"),this._renderLikes(),this._element}_setEventListeners(){const e=this._element.querySelector(".gallery__card-like_button"),t=this._element.querySelector(".gallery__card-trash-button");this._element.querySelector(".gallery__card-image").addEventListener("click",(()=>this._handleImageClick())),e.addEventListener("click",(()=>this._handleLikeClick(this._id))),t.addEventListener("click",(()=>this._handleTrashClick(this._id)))}isLiked(){return this._likes.some((e=>e._id===this._userId))}updateLikes(e){this._likes=e,this._renderLikes()}_renderLikes(){const e=this._element.querySelector(".gallery__card-like_button");this._element.querySelector(".gallery__card-like_counter").textContent=this._likes.length,this.isLiked()?e.classList.add("gallery__card-like_button_active"):e.classList.remove("gallery__card-like_button_active")}removeCard(){this._element.remove(),this._element=null}}var r=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t,this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector)}_showInputError(e,t){const r=this._element.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),r.textContent=t,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._element.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}resetValidationError(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}_setEventListeners(){this._element.addEventListener("submit",(function(e){e.preventDefault()})),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};class s{constructor(e){var t,r;r=e=>{"Escape"===e.key&&this.close()},(t="_handleEscClose")in this?Object.defineProperty(this,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[t]=r,this._popupSelector=e,this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupSelector.classList.add("popup_fadein"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupSelector.classList.remove("popup_fadein"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupSelector.addEventListener("click",(e=>{e.target.classList.contains("close-button")&&this.close()})),this._popupSelector.addEventListener("mousedown",(e=>{e.target===e.currentTarget&&this.close()}))}}class n extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".form__button"),this._buttonText=this._submitButton.textContent}_getInputValues(){const e=Array.from(this._formSelector.querySelectorAll(".form__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._formSelector.addEventListener("submit",(()=>this._handleFormSubmit(this._getInputValues())))}renderLoading(e){this._submitButton.textContent=e?"Saving...":this._buttonText}}const i=document.querySelector(".avatar"),o=document.querySelector(".edit"),a=document.querySelector(".add"),l=document.querySelector(".image"),c=document.querySelector(".delete"),d=document.querySelector(".profile__edit-button"),_=(o.querySelector(".edit__close-button"),document.querySelector(".profile__add-button")),h=(a.querySelector(".add__close-button"),l.querySelector(".image__close-button"),document.getElementById("gallery-container"),document.querySelector(".gallery__container")),u=document.querySelector(".edit__form"),m=a.querySelector(".add__form"),p=document.querySelector(".avatar__form"),g=document.getElementById("name-input"),v=document.getElementById("job-input"),y=document.getElementById("avatar-input"),b=(document.querySelector(".profile__name"),document.querySelector(".profile__name-discription"),document.querySelector(".profile__image")),S={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},E=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject("Something went wrong: ".concat(e.status)))),L=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getUserInfo(){return E("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}sendUserInfo(e){return E("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.job})})}sendUserAavatar(e){return E("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}getInitialCards(){return E("".concat(this._baseUrl,"/cards"),{headers:this._headers})}sendNewCard(e){return E("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.title,link:e.image})})}deleteCard(e){return E("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers})}likeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers})}unlikeCard(e){return E("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"6a85a377-e76e-4e72-85a9-79ee5208e36a","Content-Type":"application/json"}});let C;Promise.all([L.getInitialCards(),L.getUserInfo()]).then((t=>{let[r,s]=t;C=s._id,console.log(r);const n=new e({data:r,renderer:e=>{const t=q(e);n.addItem(t)}},h);n.renderItems(),I.setUserInfo({name:s.name,job:s.about}),I.setUserAvatar({avatar:s.avatar})})).catch((e=>{console.log(e)}));const f=new class extends s{open(e,t){const r=this._popupSelector.querySelector(".image__popup"),s=this._popupSelector.querySelector(".image__discription");r.src=e,r.alt=t,s.textContent=t,super.open()}}(l),k=new class extends s{constructor(e){super(e),this._formSelector=e.querySelector(".form"),this._submitButton=e.querySelector(".button__submit"),this._text=this._submitButton.textContent}setAction(e){this._handleSubmit=e}setEventListeners(){this._formSelector.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()})),super.setEventListeners()}renderLoading(e){this._submitButton.textContent=e?"Deleting...":this._text}}(c);function q(e){const r=new t({data:e,handleImageClick:()=>{f.open(e.link,e.name)},handleTrashClick:e=>{k.open(),k.setAction((()=>{k.renderLoading(!0),L.deleteCard(e).then((()=>{r.removeCard(),k.close()})).catch((e=>{console.log(e)})).finally((()=>{k.renderLoading(!1)}))}))},handleLikeClick:e=>{r.isLiked()?L.unlikeCard(e).then((e=>{r.updateLikes(e.likes)})).catch((e=>{console.log(e)})):L.likeCard(e).then((e=>{r.updateLikes(e.likes)})).catch((e=>{console.log(e)}))}},"#card-template",C);return r.generateCard()}const I=new class{constructor(e){let{nameSelector:t,jobSelector:r,avatarSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(r),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,job:r}=e;this._nameElement.textContent=t,this._jobElement.textContent=r}setUserAvatar(e){let{avatar:t}=e;this._avatarElement.src=t}}({nameSelector:".profile__name",jobSelector:".profile__name-discription",avatarSelector:".profile__image"}),U=new n(i,(e=>{U.renderLoading(!0),L.sendUserAavatar(e).then((()=>{I.setUserAvatar(e),U.close()})).catch((e=>{console.log(e)})).finally((()=>{U.renderLoading(!1)}))})),w=new n(o,(e=>{w.renderLoading(!0),L.sendUserInfo(e).then((()=>{I.setUserInfo({name:e.name,job:e.job}),w.close()})).catch((e=>{console.log(e)})).finally((()=>{w.renderLoading(!1)}))})),x=new n(a,(e=>{x.renderLoading(!0),L.sendNewCard(e).then((e=>{const t=q(e);h.prepend(t)})).catch((e=>{console.log(e)})).finally((()=>{x.renderLoading(!1),x.close(),m.reset(),A.resetValidationError()}))}));function B(e){g.value=e.name,v.value=e.job,y.value=e.avatar}w.setEventListeners(),x.setEventListeners(),f.setEventListeners(),k.setEventListeners(),U.setEventListeners(),b.addEventListener("click",(()=>{B(I.getUserInfo()),U.open()})),d.addEventListener("click",(()=>{B(I.getUserInfo()),w.open()})),_.addEventListener("click",(()=>{x.open()}));const j=new r(S,p),T=new r(S,u),A=new r(S,m);j.enableValidation(),T.enableValidation(),A.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSVEsTUFFYlksU0FBUSxLQUNQUyxFQUFpQnhGLGVBQWMsU0FJL0J5RixFQUFlLElBQUlyRyxFQUFjZ0IsR0FBZ0JQLElBQ3JENEYsRUFBYXpGLGVBQWMsR0FDM0IrQixFQUNHZ0IsWUFBWWxELEdBQ1oyQixNQUFNc0QsSUFDTCxNQUFNWSxFQUFlNUIsRUFBV2dCLEdBQ2hDckUsRUFBY3RILFFBQVF1TSxNQUV2QnhCLE9BQU9DLElBQ05ULFFBQVFDLElBQUlRLE1BRWJZLFNBQVEsS0FDUFUsRUFBYXpGLGVBQWMsR0FDM0J5RixFQUFhL0csUUFDYmtDLEVBQVErRSxRQUNSQyxFQUFpQmxJLDZCQVV2QixTQUFTbUksRUFBYUMsR0FDcEJoRixFQUFVZixNQUFRK0YsRUFBS25NLEtBQ3ZCb0gsRUFBU2hCLE1BQVErRixFQUFLbkQsSUFDdEIzQixFQUFZakIsTUFBUStGLEVBQUtqRCxPQVQzQjJDLEVBQWlCeEcsb0JBQ2pCeUcsRUFBYXpHLG9CQUNib0YsRUFBZ0JwRixvQkFDaEIwRixFQUFpQjFGLG9CQUNqQnNHLEVBQWdCdEcsb0JBUWhCaUMsRUFBWXJGLGlCQUFpQixTQUFTLEtBR3BDaUssRUFGbUI5QixFQUFZM0IsZUFJL0JrRCxFQUFnQnhHLFVBR2xCeUIsRUFBa0IzRSxpQkFBaUIsU0FBUyxLQUcxQ2lLLEVBRm1COUIsRUFBWTNCLGVBSS9Cb0QsRUFBaUIxRyxVQUduQjBCLEVBQWlCNUUsaUJBQWlCLFNBQVMsS0FDekM2SixFQUFhM0csVUFHZixNQUFNaUgsRUFBc0IsSUFBSUMsRUFBYzlFLEVBQWVMLEdBQ3ZEb0YsRUFBb0IsSUFBSUQsRUFBYzlFLEVBQWVQLEdBQ3JEaUYsRUFBbUIsSUFBSUksRUFBYzlFLEVBQWVOLEdBRTFEbUYsRUFBb0IzSCxtQkFDcEI2SCxFQUFrQjdILG1CQUNsQndILEVBQWlCeEgsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9zZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLWZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9hcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLWltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtc3VibWl0LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL3VzZXItaW5mby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBkYXRhLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheSA9IGRhdGE7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBjb250YWluZXJTZWxlY3RvcjtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2luaXRpYWxBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCIvLy8gQ2xhc3NlcyAvLy9cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgZGF0YSwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlVHJhc2hDbGljaywgaGFuZGxlTGlrZUNsaWNrIH0sXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIHVzZXJJZFxuICApIHtcbiAgICB0aGlzLl90ZXh0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2ltYWdlID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX293bmVyID0gZGF0YS5vd25lcjtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xuXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayA9IGhhbmRsZVRyYXNoQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmRcIik7XG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xuICB9XG5cbiAgZ2VuZXJhdGVDYXJkKCkge1xuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZC1wbGFjZVwiKTtcbiAgICBjb25zdCBsaWtlQ291bnRlciA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9jb3VudGVyXCJcbiAgICApO1xuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC10cmFzaC1idXR0b25cIlxuICAgICk7XG5cbiAgICBjYXJkSW1hZ2Uuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3RoaXMuX2ltYWdlfSlgO1xuICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RleHQ7XG4gICAgbGlrZUNvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XG5cbiAgICBpZiAodGhpcy5fb3duZXIuX2lkICE9PSB0aGlzLl91c2VySWQpIHtcbiAgICAgIHRyYXNoQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJnYWxsZXJ5X19jYXJkLXRyYXNoLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcblxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGxpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5nYWxsZXJ5X19jYXJkLWxpa2VfYnV0dG9uXCJcbiAgICApO1xuICAgIGNvbnN0IHRyYXNoQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuZ2FsbGVyeV9fY2FyZC10cmFzaC1idXR0b25cIlxuICAgICk7XG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmdhbGxlcnlfX2NhcmQtaW1hZ2VcIik7XG5cbiAgICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soKSk7XG5cbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcy5faWQpKTtcblxuICAgIHRyYXNoQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgdGhpcy5faGFuZGxlVHJhc2hDbGljayh0aGlzLl9pZClcbiAgICApO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuc29tZSgocGVyc29uKSA9PiBwZXJzb24uX2lkID09PSB0aGlzLl91c2VySWQpO1xuICB9XG5cbiAgdXBkYXRlTGlrZXMobGlrZXMpIHtcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmdhbGxlcnlfX2NhcmQtbGlrZV9idXR0b25cIlxuICAgICk7XG4gICAgY29uc3QgbGlrZUNvdW50ZXIgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5nYWxsZXJ5X19jYXJkLWxpa2VfY291bnRlclwiXG4gICAgKTtcbiAgICBsaWtlQ291bnRlci50ZXh0Q29udGVudCA9IHRoaXMuX2xpa2VzLmxlbmd0aDtcblxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xuICAgICAgbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiZ2FsbGVyeV9fY2FyZC1saWtlX2J1dHRvbl9hY3RpdmVcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImdhbGxlcnlfX2NhcmQtbGlrZV9idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcbiAgfVxufVxuIiwiLy8vIEZvcm1WYWxpZGF0b3IgLy8vXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IoY29uZmlnLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9lbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxuICAgICk7XG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXG4gICAgKTtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgICApO1xuXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICB9XG5cbiAgcmVzZXRWYWxpZGF0aW9uRXJyb3IoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gICAgfSk7XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcblxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcblxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuY2xhc3NMaXN0LmFkZChcInBvcHVwX2ZhZGVpblwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9mYWRlaW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2xvc2UtYnV0dG9uXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldCA9PT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vcG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XG4gICAgdGhpcy5fYnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybVNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIilcbiAgICApO1xuXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcblxuICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT5cbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSlcbiAgICApO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9idXR0b25UZXh0O1xuICAgIH1cbiAgfVxufVxuIiwiLy8vLy8gcG9wdXBzLy8vL1xuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJNb2R1bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmF2YXRhclwiKTtcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZU1vZHVsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdFwiKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkTW9kdWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGRcIik7XG5leHBvcnQgY29uc3QgaW1hZ2VQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaW1hZ2VcIik7XG5leHBvcnQgY29uc3QgZGVsZXRlUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZVwiKTtcblxuLy8vLy9idXR0b25zLy8vXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXG4pO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQb3B1cENsb3NlQnV0dG9uID0gZWRpdFByb2ZpbGVNb2R1bGUucXVlcnlTZWxlY3RvcihcbiAgXCIuZWRpdF9fY2xvc2UtYnV0dG9uXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBjYXJkUG9wdXBDbG9zZUJ1dHRvbiA9XG4gIGFkZENhcmRNb2R1bGUucXVlcnlTZWxlY3RvcihcIi5hZGRfX2Nsb3NlLWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBpbWFnZVBvcHVwQ2xvc2VCdXR0b24gPSBpbWFnZVBvcHVwLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLmltYWdlX19jbG9zZS1idXR0b25cIlxuKTtcblxuLy8vLyBXcmFhcGVycyAvLy8vL1xuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJnYWxsZXJ5LWNvbnRhaW5lclwiKTtcbmV4cG9ydCBjb25zdCBjYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jb250YWluZXJcIik7XG5cbi8vLy8vIEZvcm1zIC8vLy9cbmV4cG9ydCBjb25zdCBlZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhZGRGb3JtID0gYWRkQ2FyZE1vZHVsZS5xdWVyeVNlbGVjdG9yKFwiLmFkZF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hdmF0YXJfX2Zvcm1cIik7XG5cbi8vSW5wdXRzLy9cbmV4cG9ydCBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hbWUtaW5wdXRcIik7XG5leHBvcnQgY29uc3Qgam9iSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImpvYi1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXZhdGFyLWlucHV0XCIpO1xuXG4vLyBDb25zdCBFbGVtZW50cyAvL1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWUtZGlzY3JpcHRpb25cIik7XG5leHBvcnQgY29uc3QgYXZhdGFySW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuXG4vLy8gQ2FyZCBSZW5kZXJpbmcgIC8vL1xuXG5leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgdGV4dDogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRleHQ6IFwiTGFrZSBMb3Vpc2VcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRleHQ6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBpbWFnZTogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIHRleHQ6IFwiTGF0ZW1hclwiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0ZXh0OiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGltYWdlOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICB0ZXh0OiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgaW1hZ2U6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0Q29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcImZvcm1fX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxufTtcbiIsImNvbnN0IGN1c3RvbUZldGNoID0gKHVybCwgaGVhZGVyKSA9PlxuICBmZXRjaCh1cmwsIGhlYWRlcikudGhlbigocmVzKSA9PlxuICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgU29tZXRoaW5nIHdlbnQgd3Jvbmc6ICR7cmVzLnN0YXR1c31gKVxuICApO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIHNlbmRVc2VySW5mbyhpbnB1dFZhbHVlcykge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMubmFtZSxcbiAgICAgICAgYWJvdXQ6IGlucHV0VmFsdWVzLmpvYixcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgc2VuZFVzZXJBYXZhdGFyKGlucHV0VmFsdWVzKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyOiBpbnB1dFZhbHVlcy5hdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgc2VuZE5ld0NhcmQoaW5wdXRWYWx1ZXMpIHtcbiAgICByZXR1cm4gY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogaW5wdXRWYWx1ZXMudGl0bGUsXG4gICAgICAgIGxpbms6IGlucHV0VmFsdWVzLmltYWdlLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGN1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBjdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL3NlY3Rpb24uanNcIjtcblxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9jYXJkLmpzXCI7XG5cbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvZm9ybVZhbGlkYXRvci5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoU3VibWl0IGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvcG9wdXAtd2l0aC1zdWJtaXQuanNcIjtcblxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC13aXRoLWZvcm0uanNcIjtcblxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwLXdpdGgtaW1hZ2UuanNcIjtcblxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvdXNlci1pbmZvLmpzXCI7XG5cbmltcG9ydCB7XG4gIGRlZmF1bHRDb25maWcsXG4gIGNhcmRDb250YWluZXIsXG4gIGF2YXRhckltYWdlLFxuICBhdmF0YXJGb3JtLFxuICBhZGRGb3JtLFxuICBlZGl0Rm9ybSxcbiAgZWRpdEF2YXRhck1vZHVsZSxcbiAgZWRpdFByb2ZpbGVNb2R1bGUsXG4gIGFkZENhcmRNb2R1bGUsXG4gIHByb2ZpbGVBZGRCdXR0b24sXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBuYW1lSW5wdXQsXG4gIGpvYklucHV0LFxuICBhdmF0YXJJbnB1dCxcbiAgaW1hZ2VQb3B1cCxcbiAgZGVsZXRlUG9wdXAsXG59IGZyb20gXCIuLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvYXBpLmpzXCI7XG5cbi8vLyBhcGlzIGFuZCBpbml0aWFsIGxvYWRcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lblwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI2YTg1YTM3Ny1lNzZlLTRlNzItODVhOS03OWVlNTIwOGUzNmFcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5sZXQgdXNlcklkO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pXG4gIC50aGVuKChbY2FyZERhdGEsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcbiAgICBjb25zb2xlLmxvZyhjYXJkRGF0YSk7XG4gICAgY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oXG4gICAgICB7XG4gICAgICAgIGRhdGE6IGNhcmREYXRhLFxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoaXRlbSk7XG5cbiAgICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgY2FyZENvbnRhaW5lclxuICAgICk7XG5cbiAgICBjYXJkc0xpc3QucmVuZGVySXRlbXMoKTtcblxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXG4gICAgICBqb2I6IHVzZXJEYXRhLmFib3V0LFxuICAgIH0pO1xuXG4gICAgcHJvZmlsZUluZm8uc2V0VXNlckF2YXRhcih7XG4gICAgICBhdmF0YXI6IHVzZXJEYXRhLmF2YXRhcixcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuY29uc3QgaW1hZ2VQb3B1cE1vZGxlID0gbmV3IFBvcHVwV2l0aEltYWdlKGltYWdlUG9wdXApO1xuY29uc3QgZGVsZXRlUG9wdXBNb2RsZSA9IG5ldyBQb3B1cFdpdGhTdWJtaXQoZGVsZXRlUG9wdXApO1xuXG4vLy8gaW5pdGlhbCBsb2FkIGZ1bmN0aW9ucyAvLy9cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAge1xuICAgICAgZGF0YTogY2FyZERhdGEsXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoKSA9PiB7XG4gICAgICAgIGltYWdlUG9wdXBNb2RsZS5vcGVuKGNhcmREYXRhLmxpbmssIGNhcmREYXRhLm5hbWUpO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZVRyYXNoQ2xpY2s6IChpZCkgPT4ge1xuICAgICAgICBkZWxldGVQb3B1cE1vZGxlLm9wZW4oKTtcbiAgICAgICAgZGVsZXRlUG9wdXBNb2RsZS5zZXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICAgIGRlbGV0ZVBvcHVwTW9kbGUucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC5kZWxldGVDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcbiAgICAgICAgICAgICAgZGVsZXRlUG9wdXBNb2RsZS5jbG9zZSgpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgICBkZWxldGVQb3B1cE1vZGxlLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIGhhbmRsZUxpa2VDbGljazogKGlkKSA9PiB7XG4gICAgICAgIGNvbnN0IGFscmVhZHlMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xuXG4gICAgICAgIGlmIChhbHJlYWR5TGlrZWQpIHtcbiAgICAgICAgICBhcGlcbiAgICAgICAgICAgIC51bmxpa2VDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFwaVxuICAgICAgICAgICAgLmxpa2VDYXJkKGlkKVxuICAgICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcyk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0sXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIHVzZXJJZFxuICApO1xuICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuLy8vIEZvcm0gRnVuY3Rpb25zIC8vL1xuXG5jb25zdCBwcm9maWxlSW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxuICBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZS1kaXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShlZGl0QXZhdGFyTW9kdWxlLCAoaW5wdXRWYWx1ZSkgPT4ge1xuICBlZGl0QXZhdGFyUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnNlbmRVc2VyQWF2YXRhcihpbnB1dFZhbHVlKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHByb2ZpbGVJbmZvLnNldFVzZXJBdmF0YXIoaW5wdXRWYWx1ZSk7XG4gICAgICBlZGl0QXZhdGFyUG9wdXAuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShlZGl0UHJvZmlsZU1vZHVsZSwgKGlucHV0VmFsdWVzKSA9PiB7XG4gIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnNlbmRVc2VySW5mbyhpbnB1dFZhbHVlcylcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IGlucHV0VmFsdWVzLm5hbWUsIGpvYjogaW5wdXRWYWx1ZXMuam9iIH0pO1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufSk7XG5cbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGFkZENhcmRNb2R1bGUsIChpbnB1dFZhbHVlcykgPT4ge1xuICBhZGRDYXJkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnNlbmROZXdDYXJkKGlucHV0VmFsdWVzKVxuICAgIC50aGVuKChjYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkc0VsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmQpO1xuICAgICAgY2FyZENvbnRhaW5lci5wcmVwZW5kKGNhcmRzRWxlbWVudCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgYWRkRm9ybS5yZXNldCgpO1xuICAgICAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb25FcnJvcigpO1xuICAgIH0pO1xufSk7XG5cbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuaW1hZ2VQb3B1cE1vZGxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5kZWxldGVQb3B1cE1vZGxlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZnVuY3Rpb24gZmlsbEluZm9Gb3JtKGluZm8pIHtcbiAgbmFtZUlucHV0LnZhbHVlID0gaW5mby5uYW1lO1xuICBqb2JJbnB1dC52YWx1ZSA9IGluZm8uam9iO1xuICBhdmF0YXJJbnB1dC52YWx1ZSA9IGluZm8uYXZhdGFyO1xufVxuXG5hdmF0YXJJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBmb3JtSW5wdXRzID0gcHJvZmlsZUluZm8uZ2V0VXNlckluZm8oKTtcblxuICBmaWxsSW5mb0Zvcm0oZm9ybUlucHV0cyk7XG5cbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBmb3JtSW5wdXRzID0gcHJvZmlsZUluZm8uZ2V0VXNlckluZm8oKTtcblxuICBmaWxsSW5mb0Zvcm0oZm9ybUlucHV0cyk7XG5cbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRDYXJkUG9wdXAub3BlbigpO1xufSk7XG5cbmNvbnN0IGF2YXRhckZyb21WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihkZWZhdWx0Q29uZmlnLCBhdmF0YXJGb3JtKTtcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoZGVmYXVsdENvbmZpZywgZWRpdEZvcm0pO1xuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGRlZmF1bHRDb25maWcsIGFkZEZvcm0pO1xuXG5hdmF0YXJGcm9tVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL3BvcHVwLmpzXCI7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgb3BlbihpbWFnZSwgdGV4dCkge1xuICAgIGNvbnN0IGltYWdlUG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5pbWFnZV9fcG9wdXBcIik7XG4gICAgY29uc3QgaW1hZ2VQb3B1cERlY3JpcHRpb24gPSB0aGlzLl9wb3B1cFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5pbWFnZV9fZGlzY3JpcHRpb25cIlxuICAgICk7XG4gICAgaW1hZ2VQb3B1cEltYWdlLnNyYyA9IGltYWdlO1xuICAgIGltYWdlUG9wdXBJbWFnZS5hbHQgPSB0ZXh0O1xuICAgIGltYWdlUG9wdXBEZWNyaXB0aW9uLnRleHRDb250ZW50ID0gdGV4dDtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL3BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHBvcHVwU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5idXR0b25fX3N1Ym1pdFwiKTtcbiAgICB0aGlzLl90ZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuICB9XG5cbiAgc2V0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGFjdGlvbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcblxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fdGV4dDtcbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGpvYjogdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iXSwibmFtZXMiOlsiU2VjdGlvbiIsImNvbnN0cnVjdG9yIiwiY29udGFpbmVyU2VsZWN0b3IiLCJkYXRhIiwicmVuZGVyZXIiLCJ0aGlzIiwiX2luaXRpYWxBcnJheSIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsInVzZXJJZCIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVUcmFzaENsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiX3RleHQiLCJuYW1lIiwiX2ltYWdlIiwibGluayIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX293bmVyIiwib3duZXIiLCJfY2FyZFNlbGVjdG9yIiwiX3VzZXJJZCIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZVRyYXNoQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiY2FyZEltYWdlIiwiY2FyZFRpdGxlIiwibGlrZUNvdW50ZXIiLCJ0cmFzaEJ1dHRvbiIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJfcmVuZGVyTGlrZXMiLCJsaWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImlzTGlrZWQiLCJzb21lIiwicGVyc29uIiwidXBkYXRlTGlrZXMiLCJhZGQiLCJyZW1vdmVDYXJkIiwiY29uZmlnIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJyZXNldFZhbGlkYXRpb25FcnJvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZWQiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVuYWJsZVZhbGlkYXRpb24iLCJldmVudCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImUiLCJrZXkiLCJjbG9zZSIsIl9wb3B1cFNlbGVjdG9yIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybVNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsIl9idXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRMaXN0IiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImVkaXRBdmF0YXJNb2R1bGUiLCJlZGl0UHJvZmlsZU1vZHVsZSIsImFkZENhcmRNb2R1bGUiLCJpbWFnZVBvcHVwIiwiZGVsZXRlUG9wdXAiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBZGRCdXR0b24iLCJjYXJkQ29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJlZGl0Rm9ybSIsImFkZEZvcm0iLCJhdmF0YXJGb3JtIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJhdmF0YXJJbnB1dCIsImF2YXRhckltYWdlIiwiZGVmYXVsdENvbmZpZyIsImZvcm1TZWxlY3RvciIsImN1c3RvbUZldGNoIiwidXJsIiwiaGVhZGVyIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldFVzZXJJbmZvIiwic2VuZFVzZXJJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImpvYiIsInNlbmRVc2VyQWF2YXRhciIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsInNlbmROZXdDYXJkIiwidGl0bGUiLCJpbWFnZSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwiYWxsIiwiY2FyZERhdGEiLCJ1c2VyRGF0YSIsImNvbnNvbGUiLCJsb2ciLCJjYXJkc0xpc3QiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJwcm9maWxlSW5mbyIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImNhdGNoIiwiZXJyIiwiaW1hZ2VQb3B1cE1vZGxlIiwidGV4dCIsImltYWdlUG9wdXBJbWFnZSIsImltYWdlUG9wdXBEZWNyaXB0aW9uIiwic3JjIiwiYWx0IiwiZGVsZXRlUG9wdXBNb2RsZSIsInNldEFjdGlvbiIsImFjdGlvbiIsIl9oYW5kbGVTdWJtaXQiLCJjYXJkIiwiZmluYWxseSIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZUVsZW1lbnQiLCJfam9iRWxlbWVudCIsIl9hdmF0YXJFbGVtZW50IiwiZWRpdEF2YXRhclBvcHVwIiwiaW5wdXRWYWx1ZSIsImVkaXRQcm9maWxlUG9wdXAiLCJhZGRDYXJkUG9wdXAiLCJjYXJkc0VsZW1lbnQiLCJyZXNldCIsImFkZEZvcm1WYWxpZGF0b3IiLCJmaWxsSW5mb0Zvcm0iLCJpbmZvIiwiYXZhdGFyRnJvbVZhbGlkYXRvciIsIkZvcm1WYWxpZGF0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciJdLCJzb3VyY2VSb290IjoiIn0=